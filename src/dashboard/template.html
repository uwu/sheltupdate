<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="theme-color" content="#000000">
	<title>sheltupdate r__VERSION__</title>

	<script type="importmap"> { "imports": {
		"@observablehq/": "https://esm.sh/@observablehq/",
		"date-fns/": "https://esm.sh/date-fns/"
	} }</script>

	<link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="preconnect" href="https://esm.sh" crossorigin>

	<link rel="stylesheet" href="./dashboard.css">

	<link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:ital@0;1&display=swap" rel="stylesheet">

	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@unocss/reset/normalize.min.css">

	<script type="module" src="dashboard.js"></script>
</head>

<body>
	<div id="header-wrap">
		<h1>sheltupdate r__VERSION__</h1>

		<a id="install-btn" href="https://shelter.uwu.network/install">Install</a>
	</div>

	<p><em>Statistics are not live, even though relative times update.</em></p>

	<div id="upper-flex">

		<div class="stats-card basic">
			<h2 class="card-title">Server Uptime</h2>
			<p class="basic-big" id="stat-uptime"></p>
			<p class="sub">Up since <span id="stat-start-time"></span> (local time)</p>
		</div>

		<div class="stats-card">
			<h2 class="card-title">Cache Hit Ratios</h2>
			<div id="cache-grid">
				<p class="basic-big">__CACHE_PROX__</p>
				<p class="basic-big">__CACHE_V1__</p>
				<p class="basic-big">__CACHE_V2__</p>
				<p class="sub">Proxy</p>
				<p class="sub">V1 Module</p>
				<p class="sub">V2 Module</p>
			</div>
		</div>

		<div class="stats-card basic">
			<h2 class="card-title">Unique Users</h2>
			<p class="basic-big">__USER_COUNT__</p>
			<p class="sub">Users are 100% anonymised</p>
		</div>
	</div>

	<div id="lower-flex">
		<div id="left-flex" style="flex-basis: 60%;">
			<div class="stats-card">
				<h2 class="card-title">Endpoint Hit Counts</h2>
				<div id="endpoint-plot-wrap" class="plot-wrap"></div>
			</div>

			<div class="stats-card">
				<h2 class="card-title">Branches</h2>
				<div id="branches-wrap" class="plot-wrap"></div>
			</div>
		</div>

		<div class="stats-card" style="flex-basis: 40%;">
			<h2 class="card-title">Proportions</h2>

			<div id="prop-grid">
				<p>Platform</p>
				<div id="plats-wrap"></div>
				<p>Channel</p>
				<div id="chans-wrap"></div>
				<p>Host Version</p>
				<div id="hosts-wrap"></div>
				<p>API Version</p>
				<div id="apiv-wrap"></div>
			</div>
		</div>
	</div>
</body>
</html>